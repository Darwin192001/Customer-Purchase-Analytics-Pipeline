-- CREATE WAREHOUSE IF NOT EXISTS
CREATE WAREHOUSE IF NOT EXISTS TIMESHEET
WITH
    WAREHOUSE_SIZE = 'X-SMALL'
    AUTO_SUSPEND = 300
    AUTO_RESUME = TRUE
    INITIALLY_SUSPENDED = TRUE;

-- CREATE DATABASE
CREATE DATABASE MPG;

-- CREATE SCHEMA
CREATE SCHEMA MPG.TIME;

-- CREATE STAGE
CREATE STAGE MPG.TIME.CUSTOMER_STAGE;

-- CREATE FILE FORMAT
CREATE FILE FORMAT CSV_FORMAT
TYPE = 'CSV'
FIELD_OPTIONALLY_ENCLOSED_BY = '"'
SKIP_HEADER = 1;

-- CREATE TABLE
CREATE TABLE MPG.TIME.CUSTOMER_PURCHASES (
    CUSTOMER_ID INT,
    TRANSACTION_DATE TIMESTAMP,
    PRODUCT_ID INT,
    PRODUCT_CATEGORY STRING,
    AMOUNT FLOAT
);

-- SELECT DATA FROM THE TABLE (FOR TESTING PURPOSES)
SELECT * FROM MPG.TIME.CUSTOMER_PURCHASES;
